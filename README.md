# Filmorate - Платформа для оценки фильмов и социального взаимодействия

Filmorate — это приложение на Java, которое позволяет пользователям оценивать фильмы, добавлять друзей и находить общие интересы. Проект включает REST API для управления пользователями и фильмами, а также базу данных для хранения данных.

## Схема базы данных

Ниже представлена схема базы данных, разработанная для Filmorate:

![Database Schema](src/main/resources/data_base.png)

### Пояснение к схеме базы данных

Схема базы данных состоит из четырех таблиц, которые обеспечивают хранение данных пользователей, фильмов, их лайков и связей между пользователями (друзья):

- **`Users`**: Хранит информацию о пользователях.
    - `id` (первичный ключ): Уникальный идентификатор пользователя.
    - `login` : Логин пользователя.
    - `email` : Электронная почта пользователя.
    - `name`: Имя пользователя.
    - `birthday` : Дата рождения пользователя.

- **`Films`**: Хранит информацию о фильмах.
    - `id` (первичный ключ): Уникальный идентификатор фильма.
    - `name` : Название фильма.
    - `description`: Описание фильма.
    - `releaseDate` : Дата релиза (должна быть не раньше 1895-12-28).
    - `genre`: Жанр фильма.
    - `rating`: Рейтинг фильма (например, PG, R).
    - `duration` : Продолжительность фильма в минутах (должна быть неотрицательной).

- **`User_friends`**: Хранит связи между пользователями (отношение "друзья").
    - `user_id` (внешний ключ, ссылается на `Users.id`): Идентификатор пользователя.
    - `friend_id` (внешний ключ, ссылается на `Users.id`): Идентификатор друга.
    - Составной первичный ключ: `(user_id, friend_id)`.

- **`film_likes`**: Хранит информацию о лайках фильмов пользователями.
    - `film_id` : Идентификатор фильма.
    - `like_user_id` : Идентификатор пользователя, который лайкнул фильм.
    - Составной первичный ключ: `(film_id, like_user_id)`.

Схема поддерживает отношения "многие ко многим" между пользователями (друзья) и между пользователями и фильмами (лайки), что соответствует требованиям проекта.

## Примеры SQL-запросов для основных операций

Ниже приведены примеры SQL-запросов для выполнения ключевых операций приложения Filmorate.

### 1. Добавление нового пользователя

```sql
INSERT INTO Users (login, email, name, birthday)
VALUES ('john_doe', 'john@example.com', 'John Doe', '1990-05-15');
```

### 2. Получение общих друзей двух пользователей
```sql
SELECT u.*
FROM Users u
JOIN User_friends uf1 ON u.id = uf1.friend_id
JOIN User_friends uf2 ON u.id = uf2.friend_id
WHERE uf1.user_id = 1 AND uf2.user_id = 2;
```

### 3. Получение топ-10 фильмов по количеству лайков
```sql
SELECT f.*, COUNT(fl.like_user_id) as like_count
FROM Films f
LEFT JOIN film_likes fl ON f.id = fl.film_id
GROUP BY f.id
ORDER BY like_count DESC
LIMIT 10;
```